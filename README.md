- 本文基于ZMK的分体键盘固件程序，蓝牙无线方案MCU board: nice!nano；shield: Corne；配列 3*6

- 这次主要分享一下自己对keymap的认知,理解与流变.大概分成
-     1.自己认知的变化
-     2.流派区分与主要原则
-     3.介绍一下我现在使用的keymap.
  ** 1.我对Keymap认知的流变:
- 之前谈了入分体键盘的契机,半开玩笑的说是为了一碟醋包了一桌饺子.其实人体工学至少不是伪命题,从价格区间上来说,也谈不上智商税.但从顺应生理的构造,减少身体负担,到提高打字的效率来说,确实是有实打实的收益的.从物理结构上来说,分体,倾斜两个特性能减少腕管压迫和前臂过度向内旋转; 左右手分开能减少肩膀向内的压力;键位的正交,曲面排列则是减少手指移动的压力.而对于手指移动这部分,除了物理上键怎么放(是正交还是斜向,平面还是曲面,什么配列)以外,另一部分就得靠键位排布来进行优化了.
- 我自己对键位排布的认知其实也是渐进明细的,从一开始看Dactyl-Manuform觉得键盘就该长这样,到理解小配列键盘,到较为激进的3x5配列狂热信徒,再到回归折中的3x6配列,还是一个质疑-理解-成为的过程.
- 事实上keymap靠自己脑子想,太局限了.还是得多看,看完才知道什么是惊为天人,什么是别有洞天.尝试去理解别人为什么这么做->我能不能这么做->我似乎不合适这么做->我好像想到了更好的...这样站在巨人的肩膀上再寻求因地制宜的"本地化部署",才有机会找到真正适合自己的,高效且好用的keymap.
- 有个心态的问题先放在前面说.不用担心改keymap需要重新学,重新适应,太麻烦.我相信选择分体键盘的人都是不怕麻烦的,终身学习是习惯.改出来的才是最适合自己的.
  ** 2.流派区分
- 话得说在前面,这里的流派纯粹是我自己瞎总结的.但我理解这里走弯路是非必须的,直接给你们看版本答案,他的优势和劣势,你们自己心里就有数要不要买单了.简单点说就是1 homerow mod流派,以及2 其他流派; 直接上链接:
- https://precondition.github.io/home-row-mods
- 这一篇是homerow mod的科普
- https://github.com/manna-harbour/miryoku/tree/master/docs/reference
- 这一篇是homerow mod的杰出应用.几乎所有使用homerow的人,多少都借鉴了Miryoku布局.
- 简单说一下什么是homerow mod:
	- 利用了qmk/zmk键盘可以定义hold-tap的特性,即一个键,长按是输出一个键码,短按是另一个键码.
	- 把修饰键(ctrl, alt, shift, win/cmd)放到左右手的homerow(左手asdf,右手jkl;),减少每个手指打任意一个字符时手指移动的距离.注意:这里不是在说减少手腕的移动,而是更极端的最小化每个手指的移动距离.
	- 依靠切层而不是手指超伸(尤其是小拇指)去实现功能
- 这里放一张图大家直观的感受一下Miryoku布局的键位:
	- https://github.com/manna-harbour/miryoku/raw/master/data/layers/miryoku-kle-reference.png
- 所以homerow这个流派追求的就是极端的效率,当你看到Miryoku布局时,你会立刻发现这些特性以及这一理念带来的结果:
	- 3x5配列几乎变成了理所应当的选择,而对于普罗大众来说,40配列的小键盘都被戏称为"未成年键盘","不能用", 更别提36个键的3x5配列了.
	- Colemak-DH布局而不是QWER布局,强力劝退.
	- 冗余布局的修饰键,小拇指键区被替代,大拇指区域重度分配
- homerow真的有这么强吗?强! 但是有学习曲线. 强在哪里你可以想象一下当你在使用专业软件时高强度输入复杂的快捷键时,传统的键盘你需要扭曲,伸展你的小拇指,无名指,大拇指,甚至右手有时候也要从鼠标上移过来帮忙来实现某个功能.当然对于过于复杂的快捷键你可能早就忍不了,早早靠改键软件,或是宏来实现workaround了.但是homerow Mod,你要做的就是直接按下去.:)
- homerow的缺点呢: 进入和退出的代价都很大. 学习曲线之前大家都有感受了. 而3x5配列用习惯之后你可能再也回不去了.你可能需要随身带一把键盘,虽然也不麻烦吧).别小看肌肉记忆,我用惯双拼后全拼打字困难极大,给小妹改会议纪要的时候经常想捶桌子:)
- 那有没有不那么激进的方案呢?当然有的.3x6配列基本可以和"正常"键盘进行切换,丝滑程度当然因人而异.魔改程度也因人而异.你完全可以在3x6配列上复刻homerow,也可以扬长避短.冗余键位在成品键盘上很少看到,而你现在用的是客制化键盘,你定义36个enter都没人拦着你.一切为你自己的需求服务,当然前提是你得知道你自己的需求.
- 同样的,自己想是有局限的,来看一下给我启蒙的例子:
- https://mattgemmell.com/the-corne-keyboard/
- 除了布局之外,可以简单总结一下其中用到的技巧:
	- 使用Hold-tap功能实现一键多用(mute,prtscr)
	- 使用tap dance功能实现一键多用(caps lock)
	- 使用layer-tap功能实现切层
	- 使用combo功能实现不切层按键
	- 考虑拇指区键位安排:既要放高频且原来位置偏远的键(bksp,alt),又要考虑只有两根拇指,不能把所有的修饰键都放在拇指区(比如拇指区放ctrl,shift,当拇指按下了ctrl,就很难方便高效地同时按下shift.你当然可以扭动拇指来实现同时按下,但总能找到更合适的布局来高效的实现同样的功能,比如借鉴homerow mod)
- 除此之外,从别的大神那里汇总的技巧或者原则如下:
	- 习惯原则: 传统键盘用右手实现倒T布局的上下左右,我们可以在切层后在右手的IKJL也布置上下左右;传统键盘我们在小键盘上用九宫格布局实现数字输入,我们可以在切层后在右手同样布局数字输入.
	- 借鉴原则: 著名的HHKB键盘在程序员中拥有相当数量的拥趸. 把Ctrl放在Caps的位子上,或者把esc放在Caps的位子上,避免Caps这个鸡肋按键占用小拇指的"黄金地段".Vim里使用hjkl分别实现左下上右,当然可以微调成jkl;来实现.
	- 食指中指原则: 同样按键,小拇指的力量,敏捷远低于另外三个手指.有些布局放左手还是放右手,可以根据使用频率,对应小拇指还是对应食指帮助确定方案.
	- 同层处理原则:能在一个层解决的就在一个层解决不要来回切层,否则需要脑子额外去想,效率一定受影响.
- 总之,3x6配列就是极端方案往回退一步,尽量沿用传统键盘的布局,在不能忍的地方,愿意改的地方,用更合理的布局;在能负担能接受的地方维持传统.加一句:在不确定的地方冗余布局,手指会告诉你哪个方案好的.
  ** 3.我的Keymap
- 一共4层,还是比较克制的.base layer是QWER布局的默认层;num layer是实现数字和数字有关的加减乘除括号等的输入;nav layer实现光标移动以及相关的文档操作按键;media layer实现Fn,媒体控制,键盘重启,bootload以及蓝牙设置键,RGB控制键.
- Base layer:
- 字母区没有什么特殊的,3x6布局足够塞下几乎所有的字母区按键.右上角选择放弃[]保留,主要因为[]通常是成对使用,在num层做定义到了homerow;而\本来就不常用,继续留在右上角的偏远地区没什么毛病,不影响按键习惯,想找它的时候小拇指还是能找到它,低频使用也不太影响输入效率.那问题就是剩下的修饰键,功能键如何分配了.而可供分配的位置就是最左列,最右列和拇指区.
- 对于修饰键, ctrl,shift,win/cmd和alt/opt,最先定下来的是shift.因为标准指法下,大写的输入需要左右手shift配合使用的,无论是win还是macOS下,shift都是使用频率最高的榜一大哥.别的修饰键保留一个就够了,唯独shift左右都需要保留,且留在原始的位置成本最低.Caps键毫无意义,键位必须让出来.这里选择应用借鉴原则,借鉴HHKB下的Ctrl或者ESC都可,而作为成年人,我选择我全都要. Ctrl和ESC是典型可以应用mod-tap复合使用的按键,Ctrl是按住用的,ESC是单击用的.那有人要问了,万一英文输入下我要打全大写的情况怎么办?这是为啥定义了tap-dance键: 单击是shift,双击是Caps.这样即使是低频使用的工况,也能照顾到.TAB高频,常用,这里应用习惯原则,保留在原位.使用macOS的同学要问了, ` 怎么办?由于cmd+tab和cmd+`是高度相关且同质的组合功能键,最低成本的方式是复合在一个键上,我选择在nav层同样的位置放`,那我左手都不用移动,右手按一下切层就能实现cmd+tab和cmd+`的连招.剩下两个修饰键,cmd应用习惯原则在左手拇指区左侧,opt避免修饰键分布在一个拇指区,必须安排到右手拇指区,塞到不常用的最右侧.中文输入下最最常用的空格,和回退,空格按照个人习惯放在了右手拇指区,回退则放左手.del和回退配对放在左侧,回车和空格配对放在右侧.同时空格放了一个冗余,在右shift,一是符合习惯原则,二是在别的层需要有个冗余的enter. 拇指区的del和enter同时也兼任了切层功能,分别切到nav层和num层.这里有两个借鉴来的复合按键: m长按是mute,p长按是printscreen,我把截屏键绑到了第三方的截屏软件快捷键上,用起来还是很方便的.
- nav layer:
- 先讲nav层是因为nav和num会抢左右手.谁在右手区就需要考量.方向可以采用倒T布局,也可以使用左下上右布局,我这里是应用借鉴原则,使用JKL;对应左下上右布局,这样下面一列可以对应设置home,page down,page up,end,逻辑上非常合理.倒T布局虽然在打游戏的时候很好用,但是上下共用中指,效率是有问题的.那方向键的方案定了,就要定左右手了.右手无论是输入九宫格数字还是方向键都很ok;左手则相反,两者都不太行.那能不能都放右手,分配在不同的层呢?也不太行.因为后期加入mouse move之后,右手要在不同层同样键位映射鼠标移动;而数字键在不同的层也要映射Fn(举例:在num层的123对应media层的F1F2F3).然后就是应用食指中指原则,输入过程中需要输入左的工况我个人体会是比输入右要多的.那食指负责左,小拇指负责右,就定了方向放右手区,左手区自然就是数字了.此外,应用同层处理原则,右手第一行增加剪切,复制,黏贴,上一步,下一步的功能;同时左手冗余设置homerow mod,不得不说非常好使.左手第三行,冗余设置方向键,为的是单手操作方便.
- num layer:
- 先说一下为什么不能选择一字长蛇阵来输入数字.我个人的体验,一字长蛇阵反人类.尤其是输入身份证,电话号码这样的长数字的时候,传统键盘拿小键盘输入数字的效率远高于一字长蛇阵的效率.在本身就需要切层使用的前提下,不要给选择的机会,就确认下来左手(或右手)打数字是最快的.除了纯打数字,拼音选字也是高频工况,那下翻页上翻页就要放在同层好按的位置.在当前联想输入强大的背景下,大多数你想输入的字都会出现在123,不出现的情况,基本就得翻页,于是=放在3右边,-放在=上边.那回到纯数字工况,-=都有了,上面补一个+很合理吧?那加减有了,左侧补上乘除很合理吧?边角的地方再补上点号,传统位置补0,右手补上[](),右手再补冗余homerow mod,基本在数字层需要的键位就全了.有个特殊的点,右手第一列第三行补了个长按输出alt+F4,给win环境下单手关机用.
- media layer:
- 进media layer的方式定义了一个tap dance,单击是momentary瞬切层,用于即用即抛的情况;双击是to静态切层,主要给媒体键用.键位分布左手是同num层映射的Fn层,右手是媒体键,复用homerow mod配合Fn使用. 为了避免误触,在边角的地方安排了reset, bootloader, bt clear, bt 0和bt 1这些键盘控制键;最后找了空余的地方放了RGB控制键.
- 总结:
- 基本还是之前的几个原则: 亢龙有悔,从最激进的homerow mod往回退一步,寻求在与传统键盘高兼容性的布局下,根据个人需求加入homerow mod元素; 层内做到功能齐全,层间做到相似相溶;边缘区域能够忍受的前提下尽量沿用习惯布局,高频使用的情况下调整到合适的地方;积极采用好的替代方案和既有经验来做键位复用;不要吝惜冗余设置.
- 还有进步的空间吗?之后还会有啥可能得变化?ZMK下,mouse move并没有完成开发,所以现在的ZMK键盘只能控制光标,不能模拟鼠标移动.以后如果鼠标移动可以支持了,马上会加入mouse层,这可太重要了.当然更快的选择是加轨迹球.国内已经有好多大神做出来了,我也会找机会试.
- 此外:
- 除了Keymap,还有什么能帮助我们更进一步提高速度吗?有的. 键盘布局.对编程用户,英文输入用户来说,QWER改Colemak Mod-DH才是出路.但就像中文输入法改五笔,改双拼一样,键盘布局的学习曲线会更陡峭一点,看各人的需求和选择了.对我而言,QWER+双拼已经是很好的选择了,而且双拼就是基于QWER下对中文的优化,在Colemak下反而不能正常工作. 当然双拼也会带来点麻烦,就是你离不开自己的电脑/键盘,以及别人用不了你的电脑/键盘.啊,这似乎是个优点...
- 以上.很多都是个人理解,主观意味浓烈,欢迎指正.
